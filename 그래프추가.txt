{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "90a42346",
   "metadata": {
    "_cell_guid": "b1076dfc-b9ad-4769-8c92-a6c4dae69d19",
    "_uuid": "8f2839f25d086af736a60e9eeb907d3b93b6e0e5",
    "execution": {
     "iopub.execute_input": "2023-01-22T08:14:09.990451Z",
     "iopub.status.busy": "2023-01-22T08:14:09.989457Z",
     "iopub.status.idle": "2023-01-22T08:14:10.875675Z",
     "shell.execute_reply": "2023-01-22T08:14:10.874600Z"
    },
    "papermill": {
     "duration": 0.902385,
     "end_time": "2023-01-22T08:14:10.877815",
     "exception": false,
     "start_time": "2023-01-22T08:14:09.975430",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "/kaggle/input/book-recommendation-dataset/Ratings.csv\n",
      "/kaggle/input/book-recommendation-dataset/Users.csv\n",
      "/kaggle/input/book-recommendation-dataset/Books.csv\n"
     ]
    }
   ],
   "source": [
    "# This Python 3 environment comes with many helpful analytics libraries installed\n",
    "# It is defined by the kaggle/python Docker image: https://github.com/kaggle/docker-python\n",
    "# For example, here's several helpful packages to load\n",
    "\n",
    "import numpy as np # linear algebra\n",
    "import pandas as pd # data processing, CSV file I/O (e.g. pd.read_csv)\n",
    "import seaborn as sns\n",
    "import matplotlib.pyplot as plt\n",
    "import matplotlib.pyplot as plt\n",
    "%matplotlib inline\n",
    "\n",
    "# Input data files are available in the read-only \"../input/\" directory\n",
    "# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n",
    "\n",
    "import os\n",
    "for dirname, _, filenames in os.walk('/kaggle/input'):\n",
    "    for filename in filenames:\n",
    "        print(os.path.join(dirname, filename))\n",
    "\n",
    "# You can write up to 20GB to the current directory (/kaggle/working/) that gets preserved as output when you create a version using \"Save & Run All\" \n",
    "# You can also write temporary files to /kaggle/temp/, but they won't be saved outside of the current session"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "03d4d34c",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-01-22T08:14:10.902430Z",
     "iopub.status.busy": "2023-01-22T08:14:10.902157Z",
     "iopub.status.idle": "2023-01-22T08:14:12.916386Z",
     "shell.execute_reply": "2023-01-22T08:14:12.915371Z"
    },
    "papermill": {
     "duration": 2.029209,
     "end_time": "2023-01-22T08:14:12.918343",
     "exception": false,
     "start_time": "2023-01-22T08:14:10.889134",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/opt/conda/lib/python3.7/site-packages/IPython/core/interactiveshell.py:3552: DtypeWarning: Columns (3) have mixed types.Specify dtype option on import or set low_memory=False.\n",
      "  exec(code_obj, self.user_global_ns, self.user_ns)\n"
     ]
    }
   ],
   "source": [
    "#read all the input files\n",
    "books = pd.read_csv(\"../input/book-recommendation-dataset/Books.csv\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "62d66d56",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-01-22T08:14:12.941321Z",
     "iopub.status.busy": "2023-01-22T08:14:12.941000Z",
     "iopub.status.idle": "2023-01-22T08:14:13.885508Z",
     "shell.execute_reply": "2023-01-22T08:14:13.884597Z"
    },
    "papermill": {
     "duration": 0.958221,
     "end_time": "2023-01-22T08:14:13.887603",
     "exception": false,
     "start_time": "2023-01-22T08:14:12.929382",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "users = pd.read_csv(\"../input/book-recommendation-dataset/Users.csv\")\n",
    "ratings = pd.read_csv(\"../input/book-recommendation-dataset/Ratings.csv\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "d7f1e285",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-01-22T08:14:13.910689Z",
     "iopub.status.busy": "2023-01-22T08:14:13.910333Z",
     "iopub.status.idle": "2023-01-22T08:14:13.931896Z",
     "shell.execute_reply": "2023-01-22T08:14:13.931071Z"
    },
    "papermill": {
     "duration": 0.035879,
     "end_time": "2023-01-22T08:14:13.934468",
     "exception": false,
     "start_time": "2023-01-22T08:14:13.898589",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ISBN</th>\n",
       "      <th>Book-Title</th>\n",
       "      <th>Book-Author</th>\n",
       "      <th>Year-Of-Publication</th>\n",
       "      <th>Publisher</th>\n",
       "      <th>Image-URL-S</th>\n",
       "      <th>Image-URL-M</th>\n",
       "      <th>Image-URL-L</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0195153448</td>\n",
       "      <td>Classical Mythology</td>\n",
       "      <td>Mark P. O. Morford</td>\n",
       "      <td>2002</td>\n",
       "      <td>Oxford University Press</td>\n",
       "      <td>http://images.amazon.com/images/P/0195153448.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0195153448.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0195153448.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>0002005018</td>\n",
       "      <td>Clara Callan</td>\n",
       "      <td>Richard Bruce Wright</td>\n",
       "      <td>2001</td>\n",
       "      <td>HarperFlamingo Canada</td>\n",
       "      <td>http://images.amazon.com/images/P/0002005018.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0002005018.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0002005018.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0060973129</td>\n",
       "      <td>Decision in Normandy</td>\n",
       "      <td>Carlo D'Este</td>\n",
       "      <td>1991</td>\n",
       "      <td>HarperPerennial</td>\n",
       "      <td>http://images.amazon.com/images/P/0060973129.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0060973129.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0060973129.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>0374157065</td>\n",
       "      <td>Flu: The Story of the Great Influenza Pandemic...</td>\n",
       "      <td>Gina Bari Kolata</td>\n",
       "      <td>1999</td>\n",
       "      <td>Farrar Straus Giroux</td>\n",
       "      <td>http://images.amazon.com/images/P/0374157065.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0374157065.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0374157065.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0393045218</td>\n",
       "      <td>The Mummies of Urumchi</td>\n",
       "      <td>E. J. W. Barber</td>\n",
       "      <td>1999</td>\n",
       "      <td>W. W. Norton &amp;amp; Company</td>\n",
       "      <td>http://images.amazon.com/images/P/0393045218.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0393045218.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0393045218.0...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "         ISBN                                         Book-Title  \\\n",
       "0  0195153448                                Classical Mythology   \n",
       "1  0002005018                                       Clara Callan   \n",
       "2  0060973129                               Decision in Normandy   \n",
       "3  0374157065  Flu: The Story of the Great Influenza Pandemic...   \n",
       "4  0393045218                             The Mummies of Urumchi   \n",
       "\n",
       "            Book-Author Year-Of-Publication                   Publisher  \\\n",
       "0    Mark P. O. Morford                2002     Oxford University Press   \n",
       "1  Richard Bruce Wright                2001       HarperFlamingo Canada   \n",
       "2          Carlo D'Este                1991             HarperPerennial   \n",
       "3      Gina Bari Kolata                1999        Farrar Straus Giroux   \n",
       "4       E. J. W. Barber                1999  W. W. Norton &amp; Company   \n",
       "\n",
       "                                         Image-URL-S  \\\n",
       "0  http://images.amazon.com/images/P/0195153448.0...   \n",
       "1  http://images.amazon.com/images/P/0002005018.0...   \n",
       "2  http://images.amazon.com/images/P/0060973129.0...   \n",
       "3  http://images.amazon.com/images/P/0374157065.0...   \n",
       "4  http://images.amazon.com/images/P/0393045218.0...   \n",
       "\n",
       "                                         Image-URL-M  \\\n",
       "0  http://images.amazon.com/images/P/0195153448.0...   \n",
       "1  http://images.amazon.com/images/P/0002005018.0...   \n",
       "2  http://images.amazon.com/images/P/0060973129.0...   \n",
       "3  http://images.amazon.com/images/P/0374157065.0...   \n",
       "4  http://images.amazon.com/images/P/0393045218.0...   \n",
       "\n",
       "                                         Image-URL-L  \n",
       "0  http://images.amazon.com/images/P/0195153448.0...  \n",
       "1  http://images.amazon.com/images/P/0002005018.0...  \n",
       "2  http://images.amazon.com/images/P/0060973129.0...  \n",
       "3  http://images.amazon.com/images/P/0374157065.0...  \n",
       "4  http://images.amazon.com/images/P/0393045218.0...  "
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "books.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "98a64946",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-01-22T08:14:13.959718Z",
     "iopub.status.busy": "2023-01-22T08:14:13.959358Z",
     "iopub.status.idle": "2023-01-22T08:14:13.963823Z",
     "shell.execute_reply": "2023-01-22T08:14:13.962971Z"
    },
    "papermill": {
     "duration": 0.019632,
     "end_time": "2023-01-22T08:14:13.966084",
     "exception": false,
     "start_time": "2023-01-22T08:14:13.946452",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "#Selecting only useful information ( removing image URLs)\n",
    "books = books.iloc[:,:5]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "7c55606f",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-01-22T08:14:13.990116Z",
     "iopub.status.busy": "2023-01-22T08:14:13.989795Z",
     "iopub.status.idle": "2023-01-22T08:14:14.000213Z",
     "shell.execute_reply": "2023-01-22T08:14:13.998990Z"
    },
    "papermill": {
     "duration": 0.024979,
     "end_time": "2023-01-22T08:14:14.002500",
     "exception": false,
     "start_time": "2023-01-22T08:14:13.977521",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ISBN</th>\n",
       "      <th>Book-Title</th>\n",
       "      <th>Book-Author</th>\n",
       "      <th>Year-Of-Publication</th>\n",
       "      <th>Publisher</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0195153448</td>\n",
       "      <td>Classical Mythology</td>\n",
       "      <td>Mark P. O. Morford</td>\n",
       "      <td>2002</td>\n",
       "      <td>Oxford University Press</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>0002005018</td>\n",
       "      <td>Clara Callan</td>\n",
       "      <td>Richard Bruce Wright</td>\n",
       "      <td>2001</td>\n",
       "      <td>HarperFlamingo Canada</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0060973129</td>\n",
       "      <td>Decision in Normandy</td>\n",
       "      <td>Carlo D'Este</td>\n",
       "      <td>1991</td>\n",
       "      <td>HarperPerennial</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>0374157065</td>\n",
       "      <td>Flu: The Story of the Great Influenza Pandemic...</td>\n",
       "      <td>Gina Bari Kolata</td>\n",
       "      <td>1999</td>\n",
       "      <td>Farrar Straus Giroux</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0393045218</td>\n",
       "      <td>The Mummies of Urumchi</td>\n",
       "      <td>E. J. W. Barber</td>\n",
       "      <td>1999</td>\n",
       "      <td>W. W. Norton &amp;amp; Company</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "         ISBN                                         Book-Title  \\\n",
       "0  0195153448                                Classical Mythology   \n",
       "1  0002005018                                       Clara Callan   \n",
       "2  0060973129                               Decision in Normandy   \n",
       "3  0374157065  Flu: The Story of the Great Influenza Pandemic...   \n",
       "4  0393045218                             The Mummies of Urumchi   \n",
       "\n",
       "            Book-Author Year-Of-Publication                   Publisher  \n",
       "0    Mark P. O. Morford                2002     Oxford University Press  \n",
       "1  Richard Bruce Wright                2001       HarperFlamingo Canada  \n",
       "2          Carlo D'Este                1991             HarperPerennial  \n",
       "3      Gina Bari Kolata                1999        Farrar Straus Giroux  \n",
       "4       E. J. W. Barber                1999  W. W. Norton &amp; Company  "
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "books.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "89a48091",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-01-22T08:14:14.027285Z",
     "iopub.status.busy": "2023-01-22T08:14:14.026519Z",
     "iopub.status.idle": "2023-01-22T08:14:14.037084Z",
     "shell.execute_reply": "2023-01-22T08:14:14.036166Z"
    },
    "papermill": {
     "duration": 0.02476,
     "end_time": "2023-01-22T08:14:14.038863",
     "exception": false,
     "start_time": "2023-01-22T08:14:14.014103",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>User-ID</th>\n",
       "      <th>Location</th>\n",
       "      <th>Age</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>nyc, new york, usa</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>stockton, california, usa</td>\n",
       "      <td>18.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>moscow, yukon territory, russia</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>porto, v.n.gaia, portugal</td>\n",
       "      <td>17.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>farnborough, hants, united kingdom</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   User-ID                            Location   Age\n",
       "0        1                  nyc, new york, usa   NaN\n",
       "1        2           stockton, california, usa  18.0\n",
       "2        3     moscow, yukon territory, russia   NaN\n",
       "3        4           porto, v.n.gaia, portugal  17.0\n",
       "4        5  farnborough, hants, united kingdom   NaN"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "users.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "3c93d46b",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-01-22T08:14:14.064753Z",
     "iopub.status.busy": "2023-01-22T08:14:14.064085Z",
     "iopub.status.idle": "2023-01-22T08:14:14.073815Z",
     "shell.execute_reply": "2023-01-22T08:14:14.072951Z"
    },
    "papermill": {
     "duration": 0.024534,
     "end_time": "2023-01-22T08:14:14.075575",
     "exception": false,
     "start_time": "2023-01-22T08:14:14.051041",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>User-ID</th>\n",
       "      <th>ISBN</th>\n",
       "      <th>Book-Rating</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>276725</td>\n",
       "      <td>034545104X</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>276726</td>\n",
       "      <td>0155061224</td>\n",
       "      <td>5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>276727</td>\n",
       "      <td>0446520802</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>276729</td>\n",
       "      <td>052165615X</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>276729</td>\n",
       "      <td>0521795028</td>\n",
       "      <td>6</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   User-ID        ISBN  Book-Rating\n",
       "0   276725  034545104X            0\n",
       "1   276726  0155061224            5\n",
       "2   276727  0446520802            0\n",
       "3   276729  052165615X            3\n",
       "4   276729  0521795028            6"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ratings.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "d72fab71",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-01-22T08:14:14.101044Z",
     "iopub.status.busy": "2023-01-22T08:14:14.100693Z",
     "iopub.status.idle": "2023-01-22T08:14:14.222652Z",
     "shell.execute_reply": "2023-01-22T08:14:14.221997Z"
    },
    "papermill": {
     "duration": 0.137091,
     "end_time": "2023-01-22T08:14:14.224696",
     "exception": false,
     "start_time": "2023-01-22T08:14:14.087605",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "#Groupby to see which user has rated how many books\n",
    "user_rating_count = ratings.groupby('User-ID').count().sort_values(by = 'ISBN', ascending = False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "2acd1e7c",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-01-22T08:14:14.249717Z",
     "iopub.status.busy": "2023-01-22T08:14:14.249083Z",
     "iopub.status.idle": "2023-01-22T08:14:14.253683Z",
     "shell.execute_reply": "2023-01-22T08:14:14.253161Z"
    },
    "papermill": {
     "duration": 0.018634,
     "end_time": "2023-01-22T08:14:14.255220",
     "exception": false,
     "start_time": "2023-01-22T08:14:14.236586",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(105283, 2)"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "user_rating_count.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "d0e748af",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-01-22T08:14:14.279812Z",
     "iopub.status.busy": "2023-01-22T08:14:14.279147Z",
     "iopub.status.idle": "2023-01-22T08:14:14.284338Z",
     "shell.execute_reply": "2023-01-22T08:14:14.283609Z"
    },
    "papermill": {
     "duration": 0.01921,
     "end_time": "2023-01-22T08:14:14.286073",
     "exception": false,
     "start_time": "2023-01-22T08:14:14.266863",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "#keep only those users who have given ratings to more than 100 books)\n",
    "user_rating_count = user_rating_count[user_rating_count['ISBN']>100]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "86b2389d",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-01-22T08:14:14.310822Z",
     "iopub.status.busy": "2023-01-22T08:14:14.310510Z",
     "iopub.status.idle": "2023-01-22T08:14:14.315851Z",
     "shell.execute_reply": "2023-01-22T08:14:14.314896Z"
    },
    "papermill": {
     "duration": 0.019831,
     "end_time": "2023-01-22T08:14:14.317687",
     "exception": false,
     "start_time": "2023-01-22T08:14:14.297856",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(1825, 2)"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "user_rating_count.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "bbdeda38",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-01-22T08:14:14.342667Z",
     "iopub.status.busy": "2023-01-22T08:14:14.342355Z",
     "iopub.status.idle": "2023-01-22T08:14:14.930637Z",
     "shell.execute_reply": "2023-01-22T08:14:14.929850Z"
    },
    "papermill": {
     "duration": 0.60315,
     "end_time": "2023-01-22T08:14:14.932623",
     "exception": false,
     "start_time": "2023-01-22T08:14:14.329473",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "#Get counts of the ratings for each book\n",
    "book_rating_count = ratings.groupby('ISBN').count().sort_values(by = 'Book-Rating', ascending = False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "a1ae186a",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-01-22T08:14:14.957655Z",
     "iopub.status.busy": "2023-01-22T08:14:14.957350Z",
     "iopub.status.idle": "2023-01-22T08:14:14.965839Z",
     "shell.execute_reply": "2023-01-22T08:14:14.964992Z"
    },
    "papermill": {
     "duration": 0.023839,
     "end_time": "2023-01-22T08:14:14.968354",
     "exception": false,
     "start_time": "2023-01-22T08:14:14.944515",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>User-ID</th>\n",
       "      <th>Book-Rating</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ISBN</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0971880107</th>\n",
       "      <td>2502</td>\n",
       "      <td>2502</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>0316666343</th>\n",
       "      <td>1295</td>\n",
       "      <td>1295</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>0385504209</th>\n",
       "      <td>883</td>\n",
       "      <td>883</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>0060928336</th>\n",
       "      <td>732</td>\n",
       "      <td>732</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>0312195516</th>\n",
       "      <td>723</td>\n",
       "      <td>723</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>044023722X</th>\n",
       "      <td>647</td>\n",
       "      <td>647</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>0679781587</th>\n",
       "      <td>639</td>\n",
       "      <td>639</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>0142001740</th>\n",
       "      <td>615</td>\n",
       "      <td>615</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>067976402X</th>\n",
       "      <td>614</td>\n",
       "      <td>614</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>0671027360</th>\n",
       "      <td>586</td>\n",
       "      <td>586</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "            User-ID  Book-Rating\n",
       "ISBN                            \n",
       "0971880107     2502         2502\n",
       "0316666343     1295         1295\n",
       "0385504209      883          883\n",
       "0060928336      732          732\n",
       "0312195516      723          723\n",
       "044023722X      647          647\n",
       "0679781587      639          639\n",
       "0142001740      615          615\n",
       "067976402X      614          614\n",
       "0671027360      586          586"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "book_rating_count.head(10)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "2e23c190",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-01-22T08:14:14.994572Z",
     "iopub.status.busy": "2023-01-22T08:14:14.994243Z",
     "iopub.status.idle": "2023-01-22T08:14:15.000883Z",
     "shell.execute_reply": "2023-01-22T08:14:15.000004Z"
    },
    "papermill": {
     "duration": 0.021846,
     "end_time": "2023-01-22T08:14:15.002859",
     "exception": false,
     "start_time": "2023-01-22T08:14:14.981013",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "#only keep books with more than 50 ratings\n",
    "book_rating_count = book_rating_count[book_rating_count['User-ID'] > 50]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "4eb2c215",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-01-22T08:14:15.028441Z",
     "iopub.status.busy": "2023-01-22T08:14:15.028138Z",
     "iopub.status.idle": "2023-01-22T08:14:15.641880Z",
     "shell.execute_reply": "2023-01-22T08:14:15.641185Z"
    },
    "papermill": {
     "duration": 0.628981,
     "end_time": "2023-01-22T08:14:15.643914",
     "exception": false,
     "start_time": "2023-01-22T08:14:15.014933",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "ratings = ratings.merge(books, on = 'ISBN')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "e0091bfd",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-01-22T08:14:15.670759Z",
     "iopub.status.busy": "2023-01-22T08:14:15.669702Z",
     "iopub.status.idle": "2023-01-22T08:14:15.682393Z",
     "shell.execute_reply": "2023-01-22T08:14:15.681315Z"
    },
    "papermill": {
     "duration": 0.02838,
     "end_time": "2023-01-22T08:14:15.684738",
     "exception": false,
     "start_time": "2023-01-22T08:14:15.656358",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>User-ID</th>\n",
       "      <th>ISBN</th>\n",
       "      <th>Book-Rating</th>\n",
       "      <th>Book-Title</th>\n",
       "      <th>Book-Author</th>\n",
       "      <th>Year-Of-Publication</th>\n",
       "      <th>Publisher</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>276725</td>\n",
       "      <td>034545104X</td>\n",
       "      <td>0</td>\n",
       "      <td>Flesh Tones: A Novel</td>\n",
       "      <td>M. J. Rose</td>\n",
       "      <td>2002</td>\n",
       "      <td>Ballantine Books</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2313</td>\n",
       "      <td>034545104X</td>\n",
       "      <td>5</td>\n",
       "      <td>Flesh Tones: A Novel</td>\n",
       "      <td>M. J. Rose</td>\n",
       "      <td>2002</td>\n",
       "      <td>Ballantine Books</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>6543</td>\n",
       "      <td>034545104X</td>\n",
       "      <td>0</td>\n",
       "      <td>Flesh Tones: A Novel</td>\n",
       "      <td>M. J. Rose</td>\n",
       "      <td>2002</td>\n",
       "      <td>Ballantine Books</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   User-ID        ISBN  Book-Rating            Book-Title Book-Author  \\\n",
       "0   276725  034545104X            0  Flesh Tones: A Novel  M. J. Rose   \n",
       "1     2313  034545104X            5  Flesh Tones: A Novel  M. J. Rose   \n",
       "2     6543  034545104X            0  Flesh Tones: A Novel  M. J. Rose   \n",
       "\n",
       "  Year-Of-Publication         Publisher  \n",
       "0                2002  Ballantine Books  \n",
       "1                2002  Ballantine Books  \n",
       "2                2002  Ballantine Books  "
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ratings.head(3)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "70b795a2",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-01-22T08:14:15.712190Z",
     "iopub.status.busy": "2023-01-22T08:14:15.711818Z",
     "iopub.status.idle": "2023-01-22T08:14:15.717757Z",
     "shell.execute_reply": "2023-01-22T08:14:15.717103Z"
    },
    "papermill": {
     "duration": 0.022013,
     "end_time": "2023-01-22T08:14:15.719823",
     "exception": false,
     "start_time": "2023-01-22T08:14:15.697810",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(1031136, 7)"
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ratings.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "13838312",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-01-22T08:14:15.747180Z",
     "iopub.status.busy": "2023-01-22T08:14:15.746830Z",
     "iopub.status.idle": "2023-01-22T08:14:15.970221Z",
     "shell.execute_reply": "2023-01-22T08:14:15.969392Z"
    },
    "papermill": {
     "duration": 0.239361,
     "end_time": "2023-01-22T08:14:15.972260",
     "exception": false,
     "start_time": "2023-01-22T08:14:15.732899",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "ratings = ratings[ratings['User-ID'].isin(user_rating_count.index)]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "c386ebdb",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-01-22T08:14:15.998517Z",
     "iopub.status.busy": "2023-01-22T08:14:15.998189Z",
     "iopub.status.idle": "2023-01-22T08:14:16.003617Z",
     "shell.execute_reply": "2023-01-22T08:14:16.002799Z"
    },
    "papermill": {
     "duration": 0.020555,
     "end_time": "2023-01-22T08:14:16.005317",
     "exception": false,
     "start_time": "2023-01-22T08:14:15.984762",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(604854, 7)"
      ]
     },
     "execution_count": 20,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ratings.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "2a693043",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-01-22T08:14:16.031661Z",
     "iopub.status.busy": "2023-01-22T08:14:16.031357Z",
     "iopub.status.idle": "2023-01-22T08:14:16.104584Z",
     "shell.execute_reply": "2023-01-22T08:14:16.103716Z"
    },
    "papermill": {
     "duration": 0.0888,
     "end_time": "2023-01-22T08:14:16.106721",
     "exception": false,
     "start_time": "2023-01-22T08:14:16.017921",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "ratings = ratings[ratings['ISBN'].isin(book_rating_count.index)]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "b12c3cb2",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-01-22T08:14:16.133954Z",
     "iopub.status.busy": "2023-01-22T08:14:16.133196Z",
     "iopub.status.idle": "2023-01-22T08:14:16.139727Z",
     "shell.execute_reply": "2023-01-22T08:14:16.138552Z"
    },
    "papermill": {
     "duration": 0.02233,
     "end_time": "2023-01-22T08:14:16.141704",
     "exception": false,
     "start_time": "2023-01-22T08:14:16.119374",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(116873, 7)"
      ]
     },
     "execution_count": 22,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ratings.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "1e928304",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-01-22T08:14:16.168342Z",
     "iopub.status.busy": "2023-01-22T08:14:16.167798Z",
     "iopub.status.idle": "2023-01-22T08:14:16.177977Z",
     "shell.execute_reply": "2023-01-22T08:14:16.177342Z"
    },
    "papermill": {
     "duration": 0.025226,
     "end_time": "2023-01-22T08:14:16.179499",
     "exception": false,
     "start_time": "2023-01-22T08:14:16.154273",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>User-ID</th>\n",
       "      <th>ISBN</th>\n",
       "      <th>Book-Rating</th>\n",
       "      <th>Book-Title</th>\n",
       "      <th>Book-Author</th>\n",
       "      <th>Year-Of-Publication</th>\n",
       "      <th>Publisher</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>6543</td>\n",
       "      <td>034545104X</td>\n",
       "      <td>0</td>\n",
       "      <td>Flesh Tones: A Novel</td>\n",
       "      <td>M. J. Rose</td>\n",
       "      <td>2002</td>\n",
       "      <td>Ballantine Books</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>10314</td>\n",
       "      <td>034545104X</td>\n",
       "      <td>9</td>\n",
       "      <td>Flesh Tones: A Novel</td>\n",
       "      <td>M. J. Rose</td>\n",
       "      <td>2002</td>\n",
       "      <td>Ballantine Books</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>23768</td>\n",
       "      <td>034545104X</td>\n",
       "      <td>0</td>\n",
       "      <td>Flesh Tones: A Novel</td>\n",
       "      <td>M. J. Rose</td>\n",
       "      <td>2002</td>\n",
       "      <td>Ballantine Books</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>28523</td>\n",
       "      <td>034545104X</td>\n",
       "      <td>0</td>\n",
       "      <td>Flesh Tones: A Novel</td>\n",
       "      <td>M. J. Rose</td>\n",
       "      <td>2002</td>\n",
       "      <td>Ballantine Books</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>77480</td>\n",
       "      <td>034545104X</td>\n",
       "      <td>8</td>\n",
       "      <td>Flesh Tones: A Novel</td>\n",
       "      <td>M. J. Rose</td>\n",
       "      <td>2002</td>\n",
       "      <td>Ballantine Books</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    User-ID        ISBN  Book-Rating            Book-Title Book-Author  \\\n",
       "2      6543  034545104X            0  Flesh Tones: A Novel  M. J. Rose   \n",
       "4     10314  034545104X            9  Flesh Tones: A Novel  M. J. Rose   \n",
       "5     23768  034545104X            0  Flesh Tones: A Novel  M. J. Rose   \n",
       "7     28523  034545104X            0  Flesh Tones: A Novel  M. J. Rose   \n",
       "14    77480  034545104X            8  Flesh Tones: A Novel  M. J. Rose   \n",
       "\n",
       "   Year-Of-Publication         Publisher  \n",
       "2                 2002  Ballantine Books  \n",
       "4                 2002  Ballantine Books  \n",
       "5                 2002  Ballantine Books  \n",
       "7                 2002  Ballantine Books  \n",
       "14                2002  Ballantine Books  "
      ]
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ratings.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "id": "1b23b8ac",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-01-22T08:14:16.205995Z",
     "iopub.status.busy": "2023-01-22T08:14:16.205459Z",
     "iopub.status.idle": "2023-01-22T08:14:16.328604Z",
     "shell.execute_reply": "2023-01-22T08:14:16.327795Z"
    },
    "papermill": {
     "duration": 0.13874,
     "end_time": "2023-01-22T08:14:16.330594",
     "exception": false,
     "start_time": "2023-01-22T08:14:16.191854",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "piv_table = ratings.pivot_table(columns = \"User-ID\", index = \"ISBN\", values = \"Book-Rating\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "d777dbce",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-01-22T08:14:16.357057Z",
     "iopub.status.busy": "2023-01-22T08:14:16.356731Z",
     "iopub.status.idle": "2023-01-22T08:14:16.362024Z",
     "shell.execute_reply": "2023-01-22T08:14:16.361209Z"
    },
    "papermill": {
     "duration": 0.020585,
     "end_time": "2023-01-22T08:14:16.363867",
     "exception": false,
     "start_time": "2023-01-22T08:14:16.343282",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(2101, 1793)"
      ]
     },
     "execution_count": 25,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "piv_table.shape"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d3a15fef",
   "metadata": {
    "papermill": {
     "duration": 0.012377,
     "end_time": "2023-01-22T08:14:16.388952",
     "exception": false,
     "start_time": "2023-01-22T08:14:16.376575",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "So we have 2101 books and 1792 users.\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "4fbb0766",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-01-22T08:14:16.416025Z",
     "iopub.status.busy": "2023-01-22T08:14:16.415680Z",
     "iopub.status.idle": "2023-01-22T08:14:16.442097Z",
     "shell.execute_reply": "2023-01-22T08:14:16.441206Z"
    },
    "papermill": {
     "duration": 0.042308,
     "end_time": "2023-01-22T08:14:16.443986",
     "exception": false,
     "start_time": "2023-01-22T08:14:16.401678",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th>User-ID</th>\n",
       "      <th>254</th>\n",
       "      <th>507</th>\n",
       "      <th>882</th>\n",
       "      <th>1424</th>\n",
       "      <th>1435</th>\n",
       "      <th>1733</th>\n",
       "      <th>1903</th>\n",
       "      <th>2033</th>\n",
       "      <th>2110</th>\n",
       "      <th>2276</th>\n",
       "      <th>...</th>\n",
       "      <th>16161</th>\n",
       "      <th>16413</th>\n",
       "      <th>16488</th>\n",
       "      <th>16601</th>\n",
       "      <th>16634</th>\n",
       "      <th>16721</th>\n",
       "      <th>16795</th>\n",
       "      <th>16916</th>\n",
       "      <th>16943</th>\n",
       "      <th>16966</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ISBN</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>000649840X</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>002026478X</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>0020442203</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>9.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>002542730X</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>0028604199</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>0061097659</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>0061097853</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>0061097861</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>0061098035</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>0061098361</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>100 rows  100 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "User-ID     254    507    882    1424   1435   1733   1903   2033   2110   \\\n",
       "ISBN                                                                        \n",
       "000649840X    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN   \n",
       "002026478X    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN   \n",
       "0020442203    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN   \n",
       "002542730X    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN   \n",
       "0028604199    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN   \n",
       "...           ...    ...    ...    ...    ...    ...    ...    ...    ...   \n",
       "0061097659    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN   \n",
       "0061097853    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN   \n",
       "0061097861    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN   \n",
       "0061098035    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN   \n",
       "0061098361    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN   \n",
       "\n",
       "User-ID     2276   ...  16161  16413  16488  16601  16634  16721  16795  \\\n",
       "ISBN               ...                                                    \n",
       "000649840X    NaN  ...    NaN    NaN    NaN    NaN    NaN    NaN    NaN   \n",
       "002026478X    NaN  ...    NaN    NaN    0.0    NaN    NaN    NaN    NaN   \n",
       "0020442203    NaN  ...    NaN    NaN    NaN    NaN    9.0    NaN    NaN   \n",
       "002542730X    NaN  ...    NaN    NaN    NaN    NaN    NaN    NaN    0.0   \n",
       "0028604199    NaN  ...    NaN    NaN    NaN    NaN    NaN    NaN    NaN   \n",
       "...           ...  ...    ...    ...    ...    ...    ...    ...    ...   \n",
       "0061097659    NaN  ...    NaN    NaN    NaN    NaN    NaN    NaN    NaN   \n",
       "0061097853    NaN  ...    NaN    NaN    NaN    NaN    NaN    NaN    NaN   \n",
       "0061097861    NaN  ...    NaN    NaN    NaN    NaN    NaN    NaN    NaN   \n",
       "0061098035    NaN  ...    NaN    NaN    NaN    NaN    NaN    NaN    0.0   \n",
       "0061098361    NaN  ...    NaN    NaN    NaN    NaN    NaN    NaN    0.0   \n",
       "\n",
       "User-ID     16916  16943  16966  \n",
       "ISBN                             \n",
       "000649840X    NaN    NaN    NaN  \n",
       "002026478X    NaN    NaN    NaN  \n",
       "0020442203    NaN    NaN    NaN  \n",
       "002542730X    NaN    NaN    NaN  \n",
       "0028604199    NaN    NaN    NaN  \n",
       "...           ...    ...    ...  \n",
       "0061097659    NaN    NaN    NaN  \n",
       "0061097853    NaN    NaN    NaN  \n",
       "0061097861    NaN    NaN    NaN  \n",
       "0061098035    NaN    NaN    NaN  \n",
       "0061098361    NaN    NaN    NaN  \n",
       "\n",
       "[100 rows x 100 columns]"
      ]
     },
     "execution_count": 26,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "piv_table.iloc[:100, :100]"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "27f54b2e",
   "metadata": {
    "papermill": {
     "duration": 0.012739,
     "end_time": "2023-01-22T08:14:16.470166",
     "exception": false,
     "start_time": "2023-01-22T08:14:16.457427",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "As you can see it is a very sparse table with most values as NaN. We will replace Nan to 0 to logically define that if  user A has given a rating of 0 we will not recommend that to similar users. This is true if user A has not read the book as well."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "id": "62afa6a7",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-01-22T08:14:16.497865Z",
     "iopub.status.busy": "2023-01-22T08:14:16.497550Z",
     "iopub.status.idle": "2023-01-22T08:14:16.508507Z",
     "shell.execute_reply": "2023-01-22T08:14:16.507783Z"
    },
    "papermill": {
     "duration": 0.027435,
     "end_time": "2023-01-22T08:14:16.510574",
     "exception": false,
     "start_time": "2023-01-22T08:14:16.483139",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "piv_table = piv_table.fillna(0)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "id": "ee014249",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-01-22T08:14:16.539334Z",
     "iopub.status.busy": "2023-01-22T08:14:16.538534Z",
     "iopub.status.idle": "2023-01-22T08:14:16.553148Z",
     "shell.execute_reply": "2023-01-22T08:14:16.552335Z"
    },
    "papermill": {
     "duration": 0.030713,
     "end_time": "2023-01-22T08:14:16.554831",
     "exception": false,
     "start_time": "2023-01-22T08:14:16.524118",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0"
      ]
     },
     "execution_count": 28,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pd.DataFrame(piv_table).isnull().sum().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "id": "9ee18163",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-01-22T08:14:16.583142Z",
     "iopub.status.busy": "2023-01-22T08:14:16.582355Z",
     "iopub.status.idle": "2023-01-22T08:14:16.856310Z",
     "shell.execute_reply": "2023-01-22T08:14:16.855229Z"
    },
    "papermill": {
     "duration": 0.290124,
     "end_time": "2023-01-22T08:14:16.858232",
     "exception": false,
     "start_time": "2023-01-22T08:14:16.568108",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "NearestNeighbors(algorithm='brute')"
      ]
     },
     "execution_count": 29,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "from sklearn.neighbors import NearestNeighbors\n",
    "model = NearestNeighbors(algorithm='brute')\n",
    "model.fit(piv_table)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5c6befe8",
   "metadata": {
    "papermill": {
     "duration": 0.01312,
     "end_time": "2023-01-22T08:14:16.884896",
     "exception": false,
     "start_time": "2023-01-22T08:14:16.871776",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "Let's list a few books at random and see which one wwe know. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "id": "e31e1d0e",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-01-22T08:14:16.913490Z",
     "iopub.status.busy": "2023-01-22T08:14:16.913133Z",
     "iopub.status.idle": "2023-01-22T08:14:16.933406Z",
     "shell.execute_reply": "2023-01-22T08:14:16.932324Z"
    },
    "papermill": {
     "duration": 0.037294,
     "end_time": "2023-01-22T08:14:16.935745",
     "exception": false,
     "start_time": "2023-01-22T08:14:16.898451",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>User-ID</th>\n",
       "      <th>ISBN</th>\n",
       "      <th>Book-Rating</th>\n",
       "      <th>Book-Title</th>\n",
       "      <th>Book-Author</th>\n",
       "      <th>Year-Of-Publication</th>\n",
       "      <th>Publisher</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>42111</th>\n",
       "      <td>196077</td>\n",
       "      <td>0446608955</td>\n",
       "      <td>0</td>\n",
       "      <td>A Walk to Remember</td>\n",
       "      <td>Nicholas Sparks</td>\n",
       "      <td>2000</td>\n",
       "      <td>Warner Books</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>177882</th>\n",
       "      <td>85757</td>\n",
       "      <td>0380730138</td>\n",
       "      <td>0</td>\n",
       "      <td>Vinegar Hill (Oprah's Book Club (Paperback))</td>\n",
       "      <td>A. Manette Ansay</td>\n",
       "      <td>1998</td>\n",
       "      <td>Perennial</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>266131</th>\n",
       "      <td>40889</td>\n",
       "      <td>0842329218</td>\n",
       "      <td>0</td>\n",
       "      <td>Tribulation Force: The Continuing Drama of Tho...</td>\n",
       "      <td>Tim LaHaye</td>\n",
       "      <td>1997</td>\n",
       "      <td>Tyndale House Publishers</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>131662</th>\n",
       "      <td>265313</td>\n",
       "      <td>0425182908</td>\n",
       "      <td>0</td>\n",
       "      <td>Isle of Dogs</td>\n",
       "      <td>Patricia Cornwell</td>\n",
       "      <td>2002</td>\n",
       "      <td>Berkley Publishing Group</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>62337</th>\n",
       "      <td>171968</td>\n",
       "      <td>0743406176</td>\n",
       "      <td>0</td>\n",
       "      <td>If Only It Were True</td>\n",
       "      <td>Marc Levy</td>\n",
       "      <td>2000</td>\n",
       "      <td>Atria</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>67049</th>\n",
       "      <td>53614</td>\n",
       "      <td>044022165X</td>\n",
       "      <td>8</td>\n",
       "      <td>The Rainmaker</td>\n",
       "      <td>JOHN GRISHAM</td>\n",
       "      <td>1996</td>\n",
       "      <td>Dell</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>286217</th>\n",
       "      <td>30972</td>\n",
       "      <td>0446605581</td>\n",
       "      <td>0</td>\n",
       "      <td>Fat Tuesday</td>\n",
       "      <td>Sandra Brown</td>\n",
       "      <td>1998</td>\n",
       "      <td>Warner Vision</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>231547</th>\n",
       "      <td>210485</td>\n",
       "      <td>0688177751</td>\n",
       "      <td>8</td>\n",
       "      <td>Miss Julia Speaks Her Mind : A Novel</td>\n",
       "      <td>Ann B. Ross</td>\n",
       "      <td>2000</td>\n",
       "      <td>Perennial</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>155483</th>\n",
       "      <td>228764</td>\n",
       "      <td>051512608X</td>\n",
       "      <td>0</td>\n",
       "      <td>The Reef</td>\n",
       "      <td>Nora Roberts</td>\n",
       "      <td>1999</td>\n",
       "      <td>Jove Books</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>55578</th>\n",
       "      <td>51883</td>\n",
       "      <td>0440224764</td>\n",
       "      <td>0</td>\n",
       "      <td>The Partner</td>\n",
       "      <td>John Grisham</td>\n",
       "      <td>1998</td>\n",
       "      <td>Dell Publishing Company</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>117 rows  7 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "        User-ID        ISBN  Book-Rating  \\\n",
       "42111    196077  0446608955            0   \n",
       "177882    85757  0380730138            0   \n",
       "266131    40889  0842329218            0   \n",
       "131662   265313  0425182908            0   \n",
       "62337    171968  0743406176            0   \n",
       "...         ...         ...          ...   \n",
       "67049     53614  044022165X            8   \n",
       "286217    30972  0446605581            0   \n",
       "231547   210485  0688177751            8   \n",
       "155483   228764  051512608X            0   \n",
       "55578     51883  0440224764            0   \n",
       "\n",
       "                                               Book-Title        Book-Author  \\\n",
       "42111                                  A Walk to Remember    Nicholas Sparks   \n",
       "177882       Vinegar Hill (Oprah's Book Club (Paperback))   A. Manette Ansay   \n",
       "266131  Tribulation Force: The Continuing Drama of Tho...         Tim LaHaye   \n",
       "131662                                       Isle of Dogs  Patricia Cornwell   \n",
       "62337                                If Only It Were True          Marc Levy   \n",
       "...                                                   ...                ...   \n",
       "67049                                       The Rainmaker       JOHN GRISHAM   \n",
       "286217                                        Fat Tuesday       Sandra Brown   \n",
       "231547               Miss Julia Speaks Her Mind : A Novel        Ann B. Ross   \n",
       "155483                                           The Reef       Nora Roberts   \n",
       "55578                                         The Partner       John Grisham   \n",
       "\n",
       "       Year-Of-Publication                 Publisher  \n",
       "42111                 2000              Warner Books  \n",
       "177882                1998                 Perennial  \n",
       "266131                1997  Tyndale House Publishers  \n",
       "131662                2002  Berkley Publishing Group  \n",
       "62337                 2000                     Atria  \n",
       "...                    ...                       ...  \n",
       "67049                 1996                      Dell  \n",
       "286217                1998             Warner Vision  \n",
       "231547                2000                 Perennial  \n",
       "155483                1999                Jove Books  \n",
       "55578                 1998   Dell Publishing Company  \n",
       "\n",
       "[117 rows x 7 columns]"
      ]
     },
     "execution_count": 30,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ratings.sample(frac = 0.001)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d5b3b840",
   "metadata": {
    "papermill": {
     "duration": 0.013141,
     "end_time": "2023-01-22T08:14:16.962705",
     "exception": false,
     "start_time": "2023-01-22T08:14:16.949564",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "markdown",
   "id": "a8f37224",
   "metadata": {
    "papermill": {
     "duration": 0.013119,
     "end_time": "2023-01-22T08:14:16.989299",
     "exception": false,
     "start_time": "2023-01-22T08:14:16.976180",
     "status": "completed"
    },
    "tags": []
   },
   "source": []
  },
  {
   "cell_type": "markdown",
   "id": "9ec21816",
   "metadata": {
    "papermill": {
     "duration": 0.012829,
     "end_time": "2023-01-22T08:14:17.015316",
     "exception": false,
     "start_time": "2023-01-22T08:14:17.002487",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "I had to sample multiple times to get a book that I have read. 'The Fellowship of the Ring' with ISBN 0618002227 at index 196979"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "9be9ec5a",
   "metadata": {
    "papermill": {
     "duration": 0.012787,
     "end_time": "2023-01-22T08:14:17.041213",
     "exception": false,
     "start_time": "2023-01-22T08:14:17.028426",
     "status": "completed"
    },
    "tags": []
   },
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "id": "c1c95569",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-01-22T08:14:17.069405Z",
     "iopub.status.busy": "2023-01-22T08:14:17.069086Z",
     "iopub.status.idle": "2023-01-22T08:14:17.089880Z",
     "shell.execute_reply": "2023-01-22T08:14:17.089069Z"
    },
    "papermill": {
     "duration": 0.037278,
     "end_time": "2023-01-22T08:14:17.091589",
     "exception": false,
     "start_time": "2023-01-22T08:14:17.054311",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th>User-ID</th>\n",
       "      <th>254</th>\n",
       "      <th>507</th>\n",
       "      <th>882</th>\n",
       "      <th>1424</th>\n",
       "      <th>1435</th>\n",
       "      <th>1733</th>\n",
       "      <th>1903</th>\n",
       "      <th>2033</th>\n",
       "      <th>2110</th>\n",
       "      <th>2276</th>\n",
       "      <th>...</th>\n",
       "      <th>276018</th>\n",
       "      <th>276463</th>\n",
       "      <th>276680</th>\n",
       "      <th>276925</th>\n",
       "      <th>277427</th>\n",
       "      <th>277478</th>\n",
       "      <th>277639</th>\n",
       "      <th>278137</th>\n",
       "      <th>278188</th>\n",
       "      <th>278418</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ISBN</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0618002227</th>\n",
       "      <td>8.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>1 rows  1793 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "User-ID     254     507     882     1424    1435    1733    1903    2033    \\\n",
       "ISBN                                                                         \n",
       "0618002227     8.0     0.0     0.0     0.0     0.0     0.0     0.0     0.0   \n",
       "\n",
       "User-ID     2110    2276    ...  276018  276463  276680  276925  277427  \\\n",
       "ISBN                        ...                                           \n",
       "0618002227     0.0     0.0  ...     0.0     0.0     0.0     0.0     0.0   \n",
       "\n",
       "User-ID     277478  277639  278137  278188  278418  \n",
       "ISBN                                                \n",
       "0618002227     0.0     0.0     0.0     0.0     0.0  \n",
       "\n",
       "[1 rows x 1793 columns]"
      ]
     },
     "execution_count": 31,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "piv_table[piv_table.index == '0618002227']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "id": "a957cee3",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-01-22T08:14:17.120353Z",
     "iopub.status.busy": "2023-01-22T08:14:17.119806Z",
     "iopub.status.idle": "2023-01-22T08:14:17.124095Z",
     "shell.execute_reply": "2023-01-22T08:14:17.123491Z"
    },
    "papermill": {
     "duration": 0.020446,
     "end_time": "2023-01-22T08:14:17.125598",
     "exception": false,
     "start_time": "2023-01-22T08:14:17.105152",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "test_book = piv_table[piv_table.index == '0618002227'].values"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "id": "93555a9d",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-01-22T08:14:17.154016Z",
     "iopub.status.busy": "2023-01-22T08:14:17.153440Z",
     "iopub.status.idle": "2023-01-22T08:14:17.158842Z",
     "shell.execute_reply": "2023-01-22T08:14:17.157979Z"
    },
    "papermill": {
     "duration": 0.022148,
     "end_time": "2023-01-22T08:14:17.160915",
     "exception": false,
     "start_time": "2023-01-22T08:14:17.138767",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([[8., 0., 0., ..., 0., 0., 0.]])"
      ]
     },
     "execution_count": 33,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "test_book"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "id": "35978d34",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-01-22T08:14:17.190986Z",
     "iopub.status.busy": "2023-01-22T08:14:17.190633Z",
     "iopub.status.idle": "2023-01-22T08:14:17.204455Z",
     "shell.execute_reply": "2023-01-22T08:14:17.203717Z"
    },
    "papermill": {
     "duration": 0.031158,
     "end_time": "2023-01-22T08:14:17.206618",
     "exception": false,
     "start_time": "2023-01-22T08:14:17.175460",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(array([[ 0.        , 41.76122604, 41.78516483, 41.78516483, 41.86884283]]),\n",
       " array([[1626, 1001, 2088, 2098, 1299]]))"
      ]
     },
     "execution_count": 34,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "model.kneighbors(test_book)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "009678fc",
   "metadata": {
    "papermill": {
     "duration": 0.017998,
     "end_time": "2023-01-22T08:14:17.243054",
     "exception": false,
     "start_time": "2023-01-22T08:14:17.225056",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "From the doc we are getting distances and the "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "id": "ba388dbd",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-01-22T08:14:17.280613Z",
     "iopub.status.busy": "2023-01-22T08:14:17.280274Z",
     "iopub.status.idle": "2023-01-22T08:14:17.292152Z",
     "shell.execute_reply": "2023-01-22T08:14:17.291424Z"
    },
    "papermill": {
     "duration": 0.032914,
     "end_time": "2023-01-22T08:14:17.294157",
     "exception": false,
     "start_time": "2023-01-22T08:14:17.261243",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "_, closest = model.kneighbors(test_book)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "id": "3cc086d7",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-01-22T08:14:17.331701Z",
     "iopub.status.busy": "2023-01-22T08:14:17.331367Z",
     "iopub.status.idle": "2023-01-22T08:14:17.335662Z",
     "shell.execute_reply": "2023-01-22T08:14:17.334998Z"
    },
    "papermill": {
     "duration": 0.02768,
     "end_time": "2023-01-22T08:14:17.339928",
     "exception": false,
     "start_time": "2023-01-22T08:14:17.312248",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[1626 1001 2088 2098 1299]\n"
     ]
    }
   ],
   "source": [
    "for i in closest[:5]:\n",
    "    print(i)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "id": "e26d01bd",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-01-22T08:14:17.377116Z",
     "iopub.status.busy": "2023-01-22T08:14:17.376756Z",
     "iopub.status.idle": "2023-01-22T08:14:17.506428Z",
     "shell.execute_reply": "2023-01-22T08:14:17.505534Z"
    },
    "papermill": {
     "duration": 0.150562,
     "end_time": "2023-01-22T08:14:17.508361",
     "exception": false,
     "start_time": "2023-01-22T08:14:17.357799",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ISBN</th>\n",
       "      <th>Book-Title_x</th>\n",
       "      <th>Book-Author_x</th>\n",
       "      <th>Year-Of-Publication_x</th>\n",
       "      <th>Publisher_x</th>\n",
       "      <th>User-ID</th>\n",
       "      <th>Book-Rating</th>\n",
       "      <th>Book-Title_y</th>\n",
       "      <th>Book-Author_y</th>\n",
       "      <th>Year-Of-Publication_y</th>\n",
       "      <th>Publisher_y</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0440234743</td>\n",
       "      <td>The Testament</td>\n",
       "      <td>John Grisham</td>\n",
       "      <td>1999</td>\n",
       "      <td>Dell</td>\n",
       "      <td>277478</td>\n",
       "      <td>0</td>\n",
       "      <td>The Testament</td>\n",
       "      <td>John Grisham</td>\n",
       "      <td>1999</td>\n",
       "      <td>Dell</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>0440234743</td>\n",
       "      <td>The Testament</td>\n",
       "      <td>John Grisham</td>\n",
       "      <td>1999</td>\n",
       "      <td>Dell</td>\n",
       "      <td>2977</td>\n",
       "      <td>0</td>\n",
       "      <td>The Testament</td>\n",
       "      <td>John Grisham</td>\n",
       "      <td>1999</td>\n",
       "      <td>Dell</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0440234743</td>\n",
       "      <td>The Testament</td>\n",
       "      <td>John Grisham</td>\n",
       "      <td>1999</td>\n",
       "      <td>Dell</td>\n",
       "      <td>3363</td>\n",
       "      <td>0</td>\n",
       "      <td>The Testament</td>\n",
       "      <td>John Grisham</td>\n",
       "      <td>1999</td>\n",
       "      <td>Dell</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>0440234743</td>\n",
       "      <td>The Testament</td>\n",
       "      <td>John Grisham</td>\n",
       "      <td>1999</td>\n",
       "      <td>Dell</td>\n",
       "      <td>7346</td>\n",
       "      <td>9</td>\n",
       "      <td>The Testament</td>\n",
       "      <td>John Grisham</td>\n",
       "      <td>1999</td>\n",
       "      <td>Dell</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0440234743</td>\n",
       "      <td>The Testament</td>\n",
       "      <td>John Grisham</td>\n",
       "      <td>1999</td>\n",
       "      <td>Dell</td>\n",
       "      <td>9747</td>\n",
       "      <td>0</td>\n",
       "      <td>The Testament</td>\n",
       "      <td>John Grisham</td>\n",
       "      <td>1999</td>\n",
       "      <td>Dell</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "         ISBN   Book-Title_x Book-Author_x Year-Of-Publication_x Publisher_x  \\\n",
       "0  0440234743  The Testament  John Grisham                  1999        Dell   \n",
       "1  0440234743  The Testament  John Grisham                  1999        Dell   \n",
       "2  0440234743  The Testament  John Grisham                  1999        Dell   \n",
       "3  0440234743  The Testament  John Grisham                  1999        Dell   \n",
       "4  0440234743  The Testament  John Grisham                  1999        Dell   \n",
       "\n",
       "   User-ID  Book-Rating   Book-Title_y Book-Author_y Year-Of-Publication_y  \\\n",
       "0   277478            0  The Testament  John Grisham                  1999   \n",
       "1     2977            0  The Testament  John Grisham                  1999   \n",
       "2     3363            0  The Testament  John Grisham                  1999   \n",
       "3     7346            9  The Testament  John Grisham                  1999   \n",
       "4     9747            0  The Testament  John Grisham                  1999   \n",
       "\n",
       "  Publisher_y  \n",
       "0        Dell  \n",
       "1        Dell  \n",
       "2        Dell  \n",
       "3        Dell  \n",
       "4        Dell  "
      ]
     },
     "execution_count": 37,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "new_df=books.merge(ratings,on='ISBN')\n",
    "new_df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "id": "d13e9f34",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-01-22T08:14:17.538220Z",
     "iopub.status.busy": "2023-01-22T08:14:17.537853Z",
     "iopub.status.idle": "2023-01-22T08:14:17.634254Z",
     "shell.execute_reply": "2023-01-22T08:14:17.633271Z"
    },
    "papermill": {
     "duration": 0.114009,
     "end_time": "2023-01-22T08:14:17.636660",
     "exception": false,
     "start_time": "2023-01-22T08:14:17.522651",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "             ISBN                                         Book-Title  \\\n",
      "12763  0618002227  The Fellowship of the Ring (The Lord of the Ri...   \n",
      "\n",
      "            Book-Author Year-Of-Publication                 Publisher  \n",
      "12763  J. R. R. Tolkien                1999  Houghton Mifflin Company  \n",
      "             ISBN                             Book-Title     Book-Author  \\\n",
      "18670  0440944597  The Chocolate War (Laurel Leaf Books)  ROBERT CORMIER   \n",
      "\n",
      "      Year-Of-Publication    Publisher  \n",
      "18670                1986  Laurel Leaf  \n",
      "            ISBN Book-Title   Book-Author Year-Of-Publication  \\\n",
      "3028  1844262553       Free  Paul Vincent                2003   \n",
      "\n",
      "               Publisher  \n",
      "3028  Upfront Publishing  \n",
      "            ISBN               Book-Title      Book-Author  \\\n",
      "8838  3423202327  M?rder ohne Gesicht.  Henning Mankell   \n",
      "\n",
      "     Year-Of-Publication Publisher  \n",
      "8838                1999       Dtv  \n",
      "            ISBN    Book-Title   Book-Author Year-Of-Publication    Publisher\n",
      "2227  0451208811  Blood Orchid  Stuart Woods                2003  Signet Book\n"
     ]
    }
   ],
   "source": [
    "for i in closest[:5][0]:\n",
    "    print(books[books['ISBN'] == piv_table.index[i]])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "id": "4960b61f",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-01-22T08:14:17.668065Z",
     "iopub.status.busy": "2023-01-22T08:14:17.666898Z",
     "iopub.status.idle": "2023-01-22T08:14:17.796528Z",
     "shell.execute_reply": "2023-01-22T08:14:17.795887Z"
    },
    "papermill": {
     "duration": 0.146826,
     "end_time": "2023-01-22T08:14:17.798628",
     "exception": false,
     "start_time": "2023-01-22T08:14:17.651802",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "books_data=books.merge(ratings,on=\"ISBN\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "id": "976c3836",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-01-22T08:14:17.829570Z",
     "iopub.status.busy": "2023-01-22T08:14:17.828489Z",
     "iopub.status.idle": "2023-01-22T08:14:17.845214Z",
     "shell.execute_reply": "2023-01-22T08:14:17.844420Z"
    },
    "papermill": {
     "duration": 0.034287,
     "end_time": "2023-01-22T08:14:17.847377",
     "exception": false,
     "start_time": "2023-01-22T08:14:17.813090",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ISBN</th>\n",
       "      <th>Book-Title_x</th>\n",
       "      <th>Book-Author_x</th>\n",
       "      <th>Year-Of-Publication_x</th>\n",
       "      <th>Publisher_x</th>\n",
       "      <th>User-ID</th>\n",
       "      <th>Book-Rating</th>\n",
       "      <th>Book-Title_y</th>\n",
       "      <th>Book-Author_y</th>\n",
       "      <th>Year-Of-Publication_y</th>\n",
       "      <th>Publisher_y</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0440234743</td>\n",
       "      <td>The Testament</td>\n",
       "      <td>John Grisham</td>\n",
       "      <td>1999</td>\n",
       "      <td>Dell</td>\n",
       "      <td>277478</td>\n",
       "      <td>0</td>\n",
       "      <td>The Testament</td>\n",
       "      <td>John Grisham</td>\n",
       "      <td>1999</td>\n",
       "      <td>Dell</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>0440234743</td>\n",
       "      <td>The Testament</td>\n",
       "      <td>John Grisham</td>\n",
       "      <td>1999</td>\n",
       "      <td>Dell</td>\n",
       "      <td>2977</td>\n",
       "      <td>0</td>\n",
       "      <td>The Testament</td>\n",
       "      <td>John Grisham</td>\n",
       "      <td>1999</td>\n",
       "      <td>Dell</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0440234743</td>\n",
       "      <td>The Testament</td>\n",
       "      <td>John Grisham</td>\n",
       "      <td>1999</td>\n",
       "      <td>Dell</td>\n",
       "      <td>3363</td>\n",
       "      <td>0</td>\n",
       "      <td>The Testament</td>\n",
       "      <td>John Grisham</td>\n",
       "      <td>1999</td>\n",
       "      <td>Dell</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>0440234743</td>\n",
       "      <td>The Testament</td>\n",
       "      <td>John Grisham</td>\n",
       "      <td>1999</td>\n",
       "      <td>Dell</td>\n",
       "      <td>7346</td>\n",
       "      <td>9</td>\n",
       "      <td>The Testament</td>\n",
       "      <td>John Grisham</td>\n",
       "      <td>1999</td>\n",
       "      <td>Dell</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0440234743</td>\n",
       "      <td>The Testament</td>\n",
       "      <td>John Grisham</td>\n",
       "      <td>1999</td>\n",
       "      <td>Dell</td>\n",
       "      <td>9747</td>\n",
       "      <td>0</td>\n",
       "      <td>The Testament</td>\n",
       "      <td>John Grisham</td>\n",
       "      <td>1999</td>\n",
       "      <td>Dell</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>0440234743</td>\n",
       "      <td>The Testament</td>\n",
       "      <td>John Grisham</td>\n",
       "      <td>1999</td>\n",
       "      <td>Dell</td>\n",
       "      <td>9856</td>\n",
       "      <td>0</td>\n",
       "      <td>The Testament</td>\n",
       "      <td>John Grisham</td>\n",
       "      <td>1999</td>\n",
       "      <td>Dell</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>0440234743</td>\n",
       "      <td>The Testament</td>\n",
       "      <td>John Grisham</td>\n",
       "      <td>1999</td>\n",
       "      <td>Dell</td>\n",
       "      <td>11676</td>\n",
       "      <td>9</td>\n",
       "      <td>The Testament</td>\n",
       "      <td>John Grisham</td>\n",
       "      <td>1999</td>\n",
       "      <td>Dell</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>0440234743</td>\n",
       "      <td>The Testament</td>\n",
       "      <td>John Grisham</td>\n",
       "      <td>1999</td>\n",
       "      <td>Dell</td>\n",
       "      <td>13552</td>\n",
       "      <td>8</td>\n",
       "      <td>The Testament</td>\n",
       "      <td>John Grisham</td>\n",
       "      <td>1999</td>\n",
       "      <td>Dell</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "         ISBN   Book-Title_x Book-Author_x Year-Of-Publication_x Publisher_x  \\\n",
       "0  0440234743  The Testament  John Grisham                  1999        Dell   \n",
       "1  0440234743  The Testament  John Grisham                  1999        Dell   \n",
       "2  0440234743  The Testament  John Grisham                  1999        Dell   \n",
       "3  0440234743  The Testament  John Grisham                  1999        Dell   \n",
       "4  0440234743  The Testament  John Grisham                  1999        Dell   \n",
       "5  0440234743  The Testament  John Grisham                  1999        Dell   \n",
       "6  0440234743  The Testament  John Grisham                  1999        Dell   \n",
       "7  0440234743  The Testament  John Grisham                  1999        Dell   \n",
       "\n",
       "   User-ID  Book-Rating   Book-Title_y Book-Author_y Year-Of-Publication_y  \\\n",
       "0   277478            0  The Testament  John Grisham                  1999   \n",
       "1     2977            0  The Testament  John Grisham                  1999   \n",
       "2     3363            0  The Testament  John Grisham                  1999   \n",
       "3     7346            9  The Testament  John Grisham                  1999   \n",
       "4     9747            0  The Testament  John Grisham                  1999   \n",
       "5     9856            0  The Testament  John Grisham                  1999   \n",
       "6    11676            9  The Testament  John Grisham                  1999   \n",
       "7    13552            8  The Testament  John Grisham                  1999   \n",
       "\n",
       "  Publisher_y  \n",
       "0        Dell  \n",
       "1        Dell  \n",
       "2        Dell  \n",
       "3        Dell  \n",
       "4        Dell  \n",
       "5        Dell  \n",
       "6        Dell  \n",
       "7        Dell  "
      ]
     },
     "execution_count": 40,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "books_data.head(8)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "id": "517a2ba3",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-01-22T08:14:17.878713Z",
     "iopub.status.busy": "2023-01-22T08:14:17.878076Z",
     "iopub.status.idle": "2023-01-22T08:14:17.992411Z",
     "shell.execute_reply": "2023-01-22T08:14:17.991367Z"
    },
    "papermill": {
     "duration": 0.13213,
     "end_time": "2023-01-22T08:14:17.994387",
     "exception": false,
     "start_time": "2023-01-22T08:14:17.862257",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ISBN</th>\n",
       "      <th>Book-Title_x</th>\n",
       "      <th>Book-Author_x</th>\n",
       "      <th>Year-Of-Publication_x</th>\n",
       "      <th>Publisher_x</th>\n",
       "      <th>User-ID</th>\n",
       "      <th>Book-Rating</th>\n",
       "      <th>Book-Title_y</th>\n",
       "      <th>Book-Author_y</th>\n",
       "      <th>Year-Of-Publication_y</th>\n",
       "      <th>Publisher_y</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0440234743</td>\n",
       "      <td>The Testament</td>\n",
       "      <td>John Grisham</td>\n",
       "      <td>1999</td>\n",
       "      <td>Dell</td>\n",
       "      <td>277478</td>\n",
       "      <td>0</td>\n",
       "      <td>The Testament</td>\n",
       "      <td>John Grisham</td>\n",
       "      <td>1999</td>\n",
       "      <td>Dell</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>0440234743</td>\n",
       "      <td>The Testament</td>\n",
       "      <td>John Grisham</td>\n",
       "      <td>1999</td>\n",
       "      <td>Dell</td>\n",
       "      <td>2977</td>\n",
       "      <td>0</td>\n",
       "      <td>The Testament</td>\n",
       "      <td>John Grisham</td>\n",
       "      <td>1999</td>\n",
       "      <td>Dell</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0440234743</td>\n",
       "      <td>The Testament</td>\n",
       "      <td>John Grisham</td>\n",
       "      <td>1999</td>\n",
       "      <td>Dell</td>\n",
       "      <td>3363</td>\n",
       "      <td>0</td>\n",
       "      <td>The Testament</td>\n",
       "      <td>John Grisham</td>\n",
       "      <td>1999</td>\n",
       "      <td>Dell</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>0440234743</td>\n",
       "      <td>The Testament</td>\n",
       "      <td>John Grisham</td>\n",
       "      <td>1999</td>\n",
       "      <td>Dell</td>\n",
       "      <td>7346</td>\n",
       "      <td>9</td>\n",
       "      <td>The Testament</td>\n",
       "      <td>John Grisham</td>\n",
       "      <td>1999</td>\n",
       "      <td>Dell</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0440234743</td>\n",
       "      <td>The Testament</td>\n",
       "      <td>John Grisham</td>\n",
       "      <td>1999</td>\n",
       "      <td>Dell</td>\n",
       "      <td>9747</td>\n",
       "      <td>0</td>\n",
       "      <td>The Testament</td>\n",
       "      <td>John Grisham</td>\n",
       "      <td>1999</td>\n",
       "      <td>Dell</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "         ISBN   Book-Title_x Book-Author_x Year-Of-Publication_x Publisher_x  \\\n",
       "0  0440234743  The Testament  John Grisham                  1999        Dell   \n",
       "1  0440234743  The Testament  John Grisham                  1999        Dell   \n",
       "2  0440234743  The Testament  John Grisham                  1999        Dell   \n",
       "3  0440234743  The Testament  John Grisham                  1999        Dell   \n",
       "4  0440234743  The Testament  John Grisham                  1999        Dell   \n",
       "\n",
       "   User-ID  Book-Rating   Book-Title_y Book-Author_y Year-Of-Publication_y  \\\n",
       "0   277478            0  The Testament  John Grisham                  1999   \n",
       "1     2977            0  The Testament  John Grisham                  1999   \n",
       "2     3363            0  The Testament  John Grisham                  1999   \n",
       "3     7346            9  The Testament  John Grisham                  1999   \n",
       "4     9747            0  The Testament  John Grisham                  1999   \n",
       "\n",
       "  Publisher_y  \n",
       "0        Dell  \n",
       "1        Dell  \n",
       "2        Dell  \n",
       "3        Dell  \n",
       "4        Dell  "
      ]
     },
     "execution_count": 41,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "new_df=books.merge(ratings,on='ISBN')\n",
    "new_df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "id": "33418d8f",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-01-22T08:14:18.026117Z",
     "iopub.status.busy": "2023-01-22T08:14:18.025836Z",
     "iopub.status.idle": "2023-01-22T08:14:18.132621Z",
     "shell.execute_reply": "2023-01-22T08:14:18.131643Z"
    },
    "papermill": {
     "duration": 0.125259,
     "end_time": "2023-01-22T08:14:18.134870",
     "exception": false,
     "start_time": "2023-01-22T08:14:18.009611",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "new_df=books.merge(ratings,on='ISBN')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 43,
   "id": "478bab60",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-01-22T08:14:18.166322Z",
     "iopub.status.busy": "2023-01-22T08:14:18.166054Z",
     "iopub.status.idle": "2023-01-22T08:14:18.170693Z",
     "shell.execute_reply": "2023-01-22T08:14:18.170026Z"
    },
    "papermill": {
     "duration": 0.022081,
     "end_time": "2023-01-22T08:14:18.172258",
     "exception": false,
     "start_time": "2023-01-22T08:14:18.150177",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(116873, 11)"
      ]
     },
     "execution_count": 43,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "new_df.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 44,
   "id": "03724adf",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-01-22T08:14:18.203236Z",
     "iopub.status.busy": "2023-01-22T08:14:18.202294Z",
     "iopub.status.idle": "2023-01-22T08:14:18.292453Z",
     "shell.execute_reply": "2023-01-22T08:14:18.291165Z"
    },
    "papermill": {
     "duration": 0.107245,
     "end_time": "2023-01-22T08:14:18.294121",
     "exception": true,
     "start_time": "2023-01-22T08:14:18.186876",
     "status": "failed"
    },
    "tags": []
   },
   "outputs": [
    {
     "ename": "KeyError",
     "evalue": "'Book-Title'",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mKeyError\u001b[0m                                  Traceback (most recent call last)",
      "\u001b[0;32m/tmp/ipykernel_19/1049182369.py\u001b[0m in \u001b[0;36m<module>\u001b[0;34m\u001b[0m\n\u001b[0;32m----> 1\u001b[0;31m \u001b[0mdf_with_num_ratings\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mnew_df\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mgroupby\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m'Book-Title'\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcount\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mreset_index\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m'Book-Title'\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m'Book-Rating'\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mrename\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mcolumns\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m{\u001b[0m\u001b[0;34m'Book-Rating'\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m'Num_of_ratings'\u001b[0m\u001b[0;34m}\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      2\u001b[0m \u001b[0mdf_with_num_ratings\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mhead\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m/opt/conda/lib/python3.7/site-packages/pandas/core/frame.py\u001b[0m in \u001b[0;36mgroupby\u001b[0;34m(self, by, axis, level, as_index, sort, group_keys, squeeze, observed, dropna)\u001b[0m\n\u001b[1;32m   7639\u001b[0m             \u001b[0msqueeze\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0msqueeze\u001b[0m\u001b[0;34m,\u001b[0m  \u001b[0;31m# type: ignore[arg-type]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   7640\u001b[0m             \u001b[0mobserved\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mobserved\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 7641\u001b[0;31m             \u001b[0mdropna\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mdropna\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   7642\u001b[0m         )\n\u001b[1;32m   7643\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m/opt/conda/lib/python3.7/site-packages/pandas/core/groupby/groupby.py\u001b[0m in \u001b[0;36m__init__\u001b[0;34m(self, obj, keys, axis, level, grouper, exclusions, selection, as_index, sort, group_keys, squeeze, observed, mutated, dropna)\u001b[0m\n\u001b[1;32m    895\u001b[0m                 \u001b[0mobserved\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mobserved\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    896\u001b[0m                 \u001b[0mmutated\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mmutated\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 897\u001b[0;31m                 \u001b[0mdropna\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mdropna\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    898\u001b[0m             )\n\u001b[1;32m    899\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m/opt/conda/lib/python3.7/site-packages/pandas/core/groupby/grouper.py\u001b[0m in \u001b[0;36mget_grouper\u001b[0;34m(obj, key, axis, level, sort, observed, mutated, validate, dropna)\u001b[0m\n\u001b[1;32m    860\u001b[0m                 \u001b[0min_axis\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mlevel\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mgpr\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;32mFalse\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mgpr\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    861\u001b[0m             \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 862\u001b[0;31m                 \u001b[0;32mraise\u001b[0m \u001b[0mKeyError\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mgpr\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    863\u001b[0m         \u001b[0;32melif\u001b[0m \u001b[0misinstance\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mgpr\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mGrouper\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mand\u001b[0m \u001b[0mgpr\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mkey\u001b[0m \u001b[0;32mis\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    864\u001b[0m             \u001b[0;31m# Add key to exclusions\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;31mKeyError\u001b[0m: 'Book-Title'"
     ]
    }
   ],
   "source": [
    "df_with_num_ratings=new_df.groupby(['Book-Title']).count().reset_index()[['Book-Title','Book-Rating']].rename(columns={'Book-Rating':'Num_of_ratings'})\n",
    "df_with_num_ratings.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d8b71e1f",
   "metadata": {
    "execution": {
     "iopub.status.busy": "2023-01-22T08:06:11.129681Z",
     "iopub.status.idle": "2023-01-22T08:06:11.132023Z",
     "shell.execute_reply": "2023-01-22T08:06:11.131414Z",
     "shell.execute_reply.started": "2023-01-22T08:06:11.131375Z"
    },
    "papermill": {
     "duration": null,
     "end_time": null,
     "exception": null,
     "start_time": null,
     "status": "pending"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "df_with_avg_ratings=new_df.groupby(['Book-Title']).mean().reset_index()[['Book-Title','Book-Rating']].rename(columns={'Book-Rating':'avg_ratings'})\n",
    "df_with_avg_ratings.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b40f2aae",
   "metadata": {
    "execution": {
     "iopub.status.busy": "2023-01-22T08:06:11.134780Z",
     "iopub.status.idle": "2023-01-22T08:06:11.135523Z",
     "shell.execute_reply": "2023-01-22T08:06:11.135189Z",
     "shell.execute_reply.started": "2023-01-22T08:06:11.135160Z"
    },
    "papermill": {
     "duration": null,
     "end_time": null,
     "exception": null,
     "start_time": null,
     "status": "pending"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "df_with_avg_ratings.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9779d215",
   "metadata": {
    "execution": {
     "iopub.status.busy": "2023-01-22T08:06:11.137494Z",
     "iopub.status.idle": "2023-01-22T08:06:11.138164Z",
     "shell.execute_reply": "2023-01-22T08:06:11.137850Z",
     "shell.execute_reply.started": "2023-01-22T08:06:11.137820Z"
    },
    "papermill": {
     "duration": null,
     "end_time": null,
     "exception": null,
     "start_time": null,
     "status": "pending"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "books_sorted=df_with_num_ratings.merge(df_with_avg_ratings,on='Book-Title').sort_values(by=['Num_of_ratings'],ascending=False)\n",
    "books_sorted.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "44cdd5d2",
   "metadata": {
    "execution": {
     "iopub.status.busy": "2023-01-22T08:06:11.141043Z",
     "iopub.status.idle": "2023-01-22T08:06:11.141718Z",
     "shell.execute_reply": "2023-01-22T08:06:11.141423Z",
     "shell.execute_reply.started": "2023-01-22T08:06:11.141392Z"
    },
    "papermill": {
     "duration": null,
     "end_time": null,
     "exception": null,
     "start_time": null,
     "status": "pending"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "popular_books=books_sorted[books_sorted['Num_of_ratings']>300].sort_values(by=['avg_ratings'],ascending=False).head(10)\n",
    "popular_books=popular_books.merge(books,on='Book-Title').drop_duplicates('Book-Title')[['Book-Title','Book-Author','Publisher','Image-URL-M','Num_of_ratings','avg_ratings']]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7a19d647",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-01-22T08:09:54.763991Z",
     "iopub.status.busy": "2023-01-22T08:09:54.763569Z",
     "iopub.status.idle": "2023-01-22T08:09:55.047378Z",
     "shell.execute_reply": "2023-01-22T08:09:55.045975Z",
     "shell.execute_reply.started": "2023-01-22T08:09:54.763956Z"
    },
    "papermill": {
     "duration": null,
     "end_time": null,
     "exception": null,
     "start_time": null,
     "status": "pending"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "\n",
    "plt.figure(figsize=(10,6))\n",
    "sns.barplot(x=popular_books['avg_ratings'].head(10),y=popular_books['Book-Title'].head(10));"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "607d3b8a",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-01-22T08:06:31.845351Z",
     "iopub.status.busy": "2023-01-22T08:06:31.844912Z",
     "iopub.status.idle": "2023-01-22T08:06:32.137025Z",
     "shell.execute_reply": "2023-01-22T08:06:32.135511Z",
     "shell.execute_reply.started": "2023-01-22T08:06:31.845315Z"
    },
    "papermill": {
     "duration": null,
     "end_time": null,
     "exception": null,
     "start_time": null,
     "status": "pending"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "plt.figure(figsize=(10,6))\n",
    "sns.barplot(x=popular_books['Num_of_ratings'].head(10),y=popular_books['Book-Title'].head(10));"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5e8306dd",
   "metadata": {
    "papermill": {
     "duration": null,
     "end_time": null,
     "exception": null,
     "start_time": null,
     "status": "pending"
    },
    "tags": []
   },
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7377204e",
   "metadata": {
    "papermill": {
     "duration": null,
     "end_time": null,
     "exception": null,
     "start_time": null,
     "status": "pending"
    },
    "tags": []
   },
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.12"
  },
  "papermill": {
   "default_parameters": {},
   "duration": 16.907702,
   "end_time": "2023-01-22T08:14:19.029624",
   "environment_variables": {},
   "exception": true,
   "input_path": "__notebook__.ipynb",
   "output_path": "__notebook__.ipynb",
   "parameters": {},
   "start_time": "2023-01-22T08:14:02.121922",
   "version": "2.3.4"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
